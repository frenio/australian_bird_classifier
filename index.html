<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>frenio.github.io</title>
	<link rel="icon" href="protrait_icon.png" type="image/png">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<header>
		<nav>
			<ul>
				<!-- <li><a href="index.html">Home</a></li>
				<li><a href="resume.html#resume">Resume</a></li>
				<li><a href="publications.html#publications">Publications</a></li>
				<li><a href="https://scholar.google.com/citations?user=-pvktD0AAAAJ" target="_blank" rel="noopener">Scholar</a></li> -->
			</ul>
		</nav>
		<div class="hero">
			<h1><a href="index.html">Dr. Frenio Redeker</a></h1>
			<a class="image-container" href="index.html">
				<img src="portrait_bw.png" alt="Original Image">
			</a>
			<p>A chemist exploring the possibilities of deep learning.</p>
		</div>
	</header>
	
	<main>
		<section>
			<h2 id="model">Australian Bird Classifier</h2>
			<div id="exampleImages">
			    <img src="https://frenio-australian-bird-classifier.hf.space/file=rainbow_lorikeets.jpg" id="example1" width="90"><!--
			 --><img src="https://frenio-australian-bird-classifier.hf.space/file=red_crimson_rosella.jpg" id="example2" width="90"><!--
			 --><img src="https://frenio-australian-bird-classifier.hf.space/file=flying_galah.jpg" id="example2" width="90">
			</div>
			<div id="results"></div>
			<input type="file" id="imageUpload" accept="image/*">
		</section>
	</main>

	<footer class="home-footer">
		<div class="social-media">
			<!-- 
			<a href="#"><i class="fab fa-facebook-f"></i></a>
			<a href="#"><i class="fab fa-instagram"></i></a> 
			-->
			<a href="https://twitter.com/faredeker" target="_blank" rel="noopener"><i class="fab fa-twitter"></i></a>
			<a href="https://linkedin.com/in/fredeker"  target="_blank" rel="noopener"><i class="fab fa-linkedin-in"></i></a>
		</div>
		<p>&copy; 2023 Frenio Redeker</p>
	</footer>

	<script>
	  document.addEventListener('DOMContentLoaded', function() {
	    document.getElementById('imageUpload').addEventListener('change', async function() {
	      let reader = new FileReader();
	      reader.onloadend = function() {
	        const base64data = reader.result;
	        predict(base64data);
	      }

	      reader.onerror = function (error) {
	        document.getElementById('results').innerHTML = `Image load error: ${error}`;
	      };

	      // This will convert the uploaded image file to base64
	      reader.readAsDataURL(this.files[0]);
	    });


	    fetchImageAndPredict('https://frenio-australian-bird-classifier.hf.space/file=rainbow_lorikeets.jpg');

	    document.getElementById('example1').addEventListener('click', function() {
	      fetchImageAndPredict('https://frenio-australian-bird-classifier.hf.space/file=rainbow_lorikeets.jpg');
	    });	    

	    document.getElementById('example2').addEventListener('click', function() {
	      fetchImageAndPredict('https://frenio-australian-bird-classifier.hf.space/file=red_crimson_rosella.jpg');
	    });

	    document.getElementById('example3').addEventListener('click', function() {
	      fetchImageAndPredict('https://frenio-australian-bird-classifier.hf.space/file=flying_galah.jpg');
	    });	    

	  });

	  async function fetchImageAndPredict(imageSrc) {
	    const response = await fetch(imageSrc);
	    const blob = await response.blob();
	    let reader = new FileReader();
	    reader.onloadend = function() {
	      const base64data = reader.result;
	      predict(base64data);
	    };
	    reader.readAsDataURL(blob);
	  }

	  async function predict(base64data) {
	    try {
	      const response = await fetch('https://frenio-australian-bird-classifier.hf.space/run/predict', {
	        method: "POST",
	        body: JSON.stringify({ "data": [base64data] }),
	        headers: { "Content-Type": "application/json" }
	      });

	      const json = await response.json();
	      let label1 = json['data'][0]['confidences'][0]['label'].replace(/_/g, " ");
	      label1 = label1.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
	      const confidence1 = (Math.round(json['data'][0]['confidences'][0]['confidence'] * 100) / 100).toFixed(2);
	      let label2 = json['data'][0]['confidences'][1]['label'].replace(/_/g, " ");
	      label2 = label2.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
	      const confidence2 = (Math.round(json['data'][0]['confidences'][1]['confidence'] * 100) / 100).toFixed(2);
	      let label3 = json['data'][0]['confidences'][2]['label'].replace(/_/g, " ");
	      label3 = label3.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
	      const confidence3 = (Math.round(json['data'][0]['confidences'][2]['confidence'] * 100) / 100).toFixed(2);
	      document.getElementById('results').innerHTML = `<br/><img src="${base64data}" width="300"> <p>${label1}: ${confidence1}</p> <p>${label2}: ${confidence2}</p> <p>${label3}: ${confidence3}</p>`;
	    } catch (error) {
	      document.getElementById('results').innerHTML = `API error: ${error}`;
	    }
	  }
	</script>



</body>
</html>
